package com.guoxc.info.web.services;

import com.google.common.collect.Collections2;
import com.guoxc.info.bean.info.StockDayBean;
import com.guoxc.info.bean.info.StockMinuteAna;
import com.guoxc.info.dao.BsStaticDataDao;
import com.guoxc.info.dao.StockDao;
import com.guoxc.info.utils.DateUtil;
import com.guoxc.info.utils.FileUtil;
import com.guoxc.info.web.common.ConstantsInfo;
import com.guoxc.info.web.control.StockControl;
import com.guoxc.info.web.dao.BaseDao;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.io.File;
import java.sql.Timestamp;
import java.text.ParseException;
import java.util.*;

@Service
public class StockMinuteService {


    private final static Logger logger = LoggerFactory.getLogger(StockMinuteService.class);
    private static String minute2IntStr = "0931,1;0932,2;0933,3;0934,4;0935,5;0936,6;0937,7;0938,8;0939,9;0940,10;0941,11;0942,12;0943,13;0944,14;0945,15;0946,16;0947,17;0948,18;0949,19;0950,20;0951,21;0952,22;0953,23;0954,24;0955,25;0956,26;0957,27;0958,28;0959,29;1000,30;1001,31;1002,32;1003,33;1004,34;1005,35;1006,36;1007,37;1008,38;1009,39;1010,40;1011,41;1012,42;1013,43;1014,44;1015,45;1016,46;1017,47;1018,48;1019,49;1020,50;1021,51;1022,52;1023,53;1024,54;1025,55;1026,56;1027,57;1028,58;1029,59;1030,60;1031,61;1032,62;1033,63;1034,64;1035,65;1036,66;1037,67;1038,68;1039,69;1040,70;1041,71;1042,72;1043,73;1044,74;1045,75;1046,76;1047,77;1048,78;1049,79;1050,80;1051,81;1052,82;1053,83;1054,84;1055,85;1056,86;1057,87;1058,88;1059,89;1100,90;1101,91;1102,92;1103,93;1104,94;1105,95;1106,96;1107,97;1108,98;1109,99;1110,100;1111,101;1112,102;1113,103;1114,104;1115,105;1116,106;1117,107;1118,108;1119,109;1120,110;1121,111;1122,112;1123,113;1124,114;1125,115;1126,116;1127,117;1128,118;1129,119;1130,120;1301,121;1302,122;1303,123;1304,124;1305,125;1306,126;1307,127;1308,128;1309,129;1310,130;1311,131;1312,132;1313,133;1314,134;1315,135;1316,136;1317,137;1318,138;1319,139;1320,140;1321,141;1322,142;1323,143;1324,144;1325,145;1326,146;1327,147;1328,148;1329,149;1330,150;1331,151;1332,152;1333,153;1334,154;1335,155;1336,156;1337,157;1338,158;1339,159;1340,160;1341,161;1342,162;1343,163;1344,164;1345,165;1346,166;1347,167;1348,168;1349,169;1350,170;1351,171;1352,172;1353,173;1354,174;1355,175;1356,176;1357,177;1358,178;1359,179;1400,180;1401,181;1402,182;1403,183;1404,184;1405,185;1406,186;1407,187;1408,188;1409,189;1410,190;1411,191;1412,192;1413,193;1414,194;1415,195;1416,196;1417,197;1418,198;1419,199;1420,200;1421,201;1422,202;1423,203;1424,204;1425,205;1426,206;1427,207;1428,208;1429,209;1430,210;1431,211;1432,212;1433,213;1434,214;1435,215;1436,216;1437,217;1438,218;1439,219;1440,220;1441,221;1442,222;1443,223;1444,224;1445,225;1446,226;1447,227;1448,228;1449,229;1450,230;1451,231;1452,232;1453,233;1454,234;1455,235;1456,236;1457,237;1458,238;1459,239;1500,240;";
    private static final String  stockBaseVol = "603893,50;600265,50;603290,50;600785,50;600234,50;603096,50;603860,50;603665,50;603039,50;603991,50;603203,50;000803,50;600774,50;002779,50;002718,50;600421,50;603038,50;000048,50;603199,50;002833,50;603040,50;002880,50;603737,50;603822,50;603656,50;603416,50;603208,50;603033,50;600301,50;603908,50;603661,50;603955,50;603833,50;603444,50;600817,50;603319,50;002801,50;002802,50;603041,50;603585,50;603180,50;002729,50;600262,50;603990,50;603868,50;002287,50;603139,50;603926,50;600697,50;002728,50;603679,50;603200,50;002749,50;603580,50;600455,50;603331,50;603076,50;603306,50;603037,50;600847,50;002735,50;002816,50;603909,50;601799,50;603029,50;600593,50;603136,50;600444,50;603985,50;000403,50;603337,50;000004,50;603351,50;603578,50;002890,50;603579,50;600629,50;603730,50;002144,50;002817,50;002393,50;603090,50;002275,50;002832,50;000096,50;600385,100;600137,100;603866,100;603238,100;002186,100;603638,100;603330,100;603355,100;600228,100;603268,100;600857,100;603960,100;603217,100;603159,100;603757,100;603806,100;000695,100;002841,100;002159,100;603768,100;603507,100;600097,100;603898,100;002715,100;002884,100;603060,100;603871,100;600897,100;002896,100;002891,100;600007,100;002732,100;603658,100;002395,100;600661,100;002187,100;603001,100;603639,100;002781,100;600976,100;603089,100;603569,100;603338,100;000985,100;000668,100;002767,100;600605,100;603429,100;002811,100;601007,100;603788,100;002678,100;002789,100;603269,100;603158,100;603567,100;603811,100;002778,100;600272,100;603316,100;002595,100;601579,100;002956,100;603677,100;600211,100;002932,100;603396,100;603079,100;002876,100;002825,100;603685,100;603086,100;603339,100;600091,100;603877,100;600608,100;603968,100;603883,100;603855,100;603989,100;002633,100;603887,100;002039,100;603127,100;603116,100;600647,100;002394,100;603595,100;603709,100;603666,100;603359,100;603801,100;002912,100;603458,100;600793,100;000504,100;603896,100;002791,100;600749,100;603088,100;603519,100;603315,100;603611,100;002883,100;002777,100;002561,100;002887,100;002868,100;603233,100;000880,100;603861,100;603698,100;603819,100;000028,100;002873,100;603129,100;603663,100;002623,100;601368,100;603779,100;603520,100;603059,100;603232,100;603311,100;603637,100;601696,100;600834,100;603729,100;600612,100;002849,100;603388,100;603838,100;000502,100;603358,100;002032,100;002809,100;600714,100;002857,100;603922,100;603810,100;002713,100;603031,100;603161,100;600182,100;603226,100;603518,100;002901,100;000526,100;603809,100;002818,100;603586,100;603869,100;600680,100;603939,100;603726,100;002831,100;002058,100;600753,100;603229,100;000715,100;600148,100;603813,100;603903,100;600475,100;603889,100;603223,100;002861,100;002763,100;603380,100;600452,100;600379,100;002757,100;603818,100;600694,100;603165,100;603345,100;600843,100;000869,100;000042,100;600241,100;002821,100;600861,100;603320,100;002878,100;600767,100;603218,100;002621,100;002820,100;600882,100;002853,100;603566,100;002674,100;002543,100;002858,100;000524,100;603326,100;603515,100;002473,100;603286,100;600990,100;000798,100;603277,100;603958,100;002940,100;603508,100;603725,100;603131,100;002790,100;603728,100;002760,100;002403,100;603360,100;000430,100;603669,100;603309,100;603816,100;603298,100;002852,100;002053,100;002227,100;002295,100;002829,100;600563,100;600071,100;600723,100;603100,100;600706,100;603166,100;002627,100;002598,100;002768,100;603303,100;603099,100;000661,100;603798,100;002800,100;603680,100;600764,100;600573,100;603368,100;600696,100;000710,100;603699,100;603179,100;000411,100;600551,100;600961,100;601127,100;002380,100;002205,100;603600,100;603313,100;603007,100;600561,100;600818,100;002730,100;603098,100;603558,100;002859,100;002738,100;603236,100;000929,100;603727,100;603859,100;000779,100;603028,100;600883,100;603278,100;603659,100;603773,100;603886,100;603222,100;603078,100;000534,100;603633,100;603605,100;000617,100;002014,100;600306,100;603239,100;603535,100;600768,100;002799,100;603599,100;002921,100;603789,100;603758,100;002319,100;601566,100;002753,100;603228,100;603630,100;603506,100;603297,100;603615,100;600833,100;603123,100;603055,100;603716,100;603006,100;603214,100;603178,100;603488,100;002773,100;603617,100;603043,100;603590,100;603556,100;603900,100;002748,100;002780,100;603187,100;600389,100;002722,100;000020,100;601595,100;002899,100;600965,100;603938,100;603383,100;603721,100;603496,100;002836,100;603020,100;600814,100;601177,100;603015,100;002824,100;002248,100;002898,100;603696,100;002798,100;002862,100;603500,100;002843,100;002968,100;002034,100;002803,100;002096,100;002734,100;002785,100;002850,100;603332,100;603036,100;603755,100;000418,100;002412,100;002612,100;600841,100;002864,100;600650,100;002686,100;603160,100;603878,100;000899,100;603966,100;002867,100;603823,100;600992,100;603976,100;600419,100;002150,100;002860,100;603628,100;603808,100;002658,100;600184,100;002336,100;600865,100;600644,100;603928,100;603025,100;000619,100;603708,100;002322,100;600639,100;002335,100;603021,100;000978,100;600615,100;002827,100;603156,100;603657,100;002719,100;001872,100;002952,100;002324,100;002679,100;002193,100;002286,100;600671,100;600302,100;002838,100;603527,100;603378,100;000995,100;002520,100;002875,100;603192,100;002646,100;000828,100;600628,100;601500,100;600506,100;603197,100;000719,100;600429,100;603963,100;002290,100;603919,100;002752,100;603786,100;600858,100;603882,100;603385,100;002107,100;002955,100;603018,100;603917,100;603607,100;002826,100;603181,100;002173,100;603707,100;002870,100;603016,100;603301,100;603829,100;002756,100;002918,100;603918,100;603655,100;603517,100;603978,100;002871,100;603895,100;002892,100;600719,100;002566,100;603767,100;603722,100;601882,100;603568,100;002933,100;600250,100;002813,100;603839,100;002810,100;002805,100;603322,100;002059,100;603377,100;600486,100;002046,100;000421,100;603499,100;000596,100;002615,100;600189,100;603667,100;600180,100;603101,100;603577,100;002037,100;603110,100;603387,100;600679,100;603583,100;000953,100;603899,100;000705,100;603538,100;600510,100;002788,100;600167,100;600054,100;002647,100;600132,100;603629,100;002462,100;600051,100;600778,100;000913,100;603017,100;603266,100;002830,100;603979,100;600638,100;002116,100;603703,100;002823,100;600378,100;603022,100;603776,100;002931,100;002620,100;600382,100;603897,100;002889,100;600099,100;603177,100;002282,100;600403,100;603880,100;002847,100;002879,100;002724,100;002900,100;002819,100;600683,100;601158,100;002644,100;600889,100;603185,100;601677,100;000546,100;603977,100;603717,100;603879,100;601021,100;002787,100;002569,100;002003,100;601900,100;603828,100;600898,100;600769,100;603933,100;603848,100;000736,100;000726,100;002062,100;002869,100;600356,100;603817,100;603711,100;000023,100;002090,100;603997,100;002705,100;002796,100;600083,100;600851,100;600724,100;000920,100;000419,100;002851,100;002088,100;002120,100;002616,100;600505,100;603183,100;002775,100;002882,100;603587,100;600283,100;002913,100;603288,100;603356,100;603365,100;600520,100;002438,100;603700,100;603010,100;000919,100;002758,100;603379,100;601965,100;002568,100;601163,100;603258,100;603486,100;002209,200;600979,200;600983,200;002553,100;002682,100;600548,200;603186,200;000428,200;603393,200;603225,200;603536,200;600508,200;600665,200;603103,200;002812,200;600725,200;600238,200;600493,200;600663,200;600763,200;600617,200;002082,200;603959,200;002671,200;600168,200;601199,200;600101,200;002360,200;002188,200;000550,200;002253,200;603683,200;002855,200;000679,200;603516,200;603970,200;603035,200;600461,200;600129,200;603988,200;002576,200;600367,200;603050,200;600243,200;002315,200;603881,200;603260,200;603489,200;002771,200;603333,200;002165,200;600890,200;002599,200;600599,200;603800,200;603856,200;601126,200;603929,200;600982,200;002741,200;000037,200;002190,200;002723,200;002963,200;000605,200;002911,200;002406,200;000688,200;603983,200;000551,200;002959,200;600012,200;000663,200;600754,200;002420,200;002923,200;000737,200;600215,200;603138,200;600819,200;002541,200;000635,200;000923,200;002840,200;600969,200;002338,200;002346,200;600987,200;002293,200;600616,200;603610,200;000972,200;002033,200;603023,200;002690,200;600732,200;600829,200;600828,200;600556,200;600483,200;600854,200;002534,200;600098,200;000906,200;000153,200;002363,200;002856,200;002661,200;002922,200;002806,200;601811,200;000678,200;002935,200;600780,200;000611,200;603357,200;600619,200;002886,200;002731,200;002919,200;601999,200;603713,200;600729,200;600933,200;002667,200;002136,200;603533,200;603787,200;603305,200;603608,200;601100,200;603321,200;600529,200;600543,200;600423,200;002101,200;000565,200;600885,200;600962,200;000692,200;000429,200;002970,200;000915,200;002960,200;600519,200;000863,200;000626,200;000889,200;603066,200;002469,200;000708,200;603042,200;000881,200;002942,200;603466,200;603589,200;600746,200;002743,200;600742,200;002943,200;000782,200;603603,200;002751,200;600381,200;002653,200;002608,200;603167,200;600248,200;000608,200;600511,200;603289,200;601226,200;603080,200;002920,200;603689,200;002381,200;600315,200;002951,200;002084,200;600370,200;603003,200;603398,200;603109,200;600681,200;600995,200;002533,200;603279,200;000888,200;603867,200;002592,200;601968,200;002397,200;000570,200;600463,200;600526,200;601188,200;603797,200;603317,200;603987,200;002893,200;002888,200;603168,200;002095,200;600731,200;002331,200;002762,200;600058,200;002196,200;600784,200;002066,200;603980,200;603826,200;002349,200;603063,200;002513,200;002659,200;000628,200;603613,200;000759,200;000548,200;603668,200;603688,200;000819,200;002906,200;000893,200;601028,200;002837,200;002698,200;002845,200;603045,200;600860,200;000538,200;600791,200;002216,200;600980,200;002111,200;603906,200;603890,200;000952,200;002391,200;002808,200;600488,200;603916,200;000025,200;002706,200;603937,200;002755,200;600750,200;603030,200;600693,200;600579,200;603992,200;600560,200;600587,200;002928,200;603912,200;603308,200;600692,200;002793,200;600771,200;600985,200;603058,200;000909,200;600053,200;002915,200;002242,200;000062,200;002846,200;603069,200;601366,200;603196,200;600479,200;600377,200;000032,200;601339,200;000582,200;603596,200;600835,200;603283,200;601966,200;000541,200;600824,200;600159,200;600557,200;603133,200;002574,200;600636,200;002740,200;601567,200;600436,200;600993,200;002527,200;600287,200;000999,200;603825,200;002772,200;002792,200;000590,200;002685,200;600896,200;600275,200;000501,200;002727,200;600648,200;002026,200;000833,200;603421,200;603083,200;000026,200;603329,200;002925,200;000553,200;002637,200;002865,200;002313,200;601137,200;000011,200;600482,200;600826,200;002557,200;002339,200;000030,200;600178,200;000697,200;603612,200;600620,200;000539,200;000968,200;000685,200;603662,200;000701,200;002765,200;002365,200;000423,200;600838,200;002015,200;002529,200;600796,200;002950,200;002452,200;002917,200;002577,200;600329,200;002927,200;600523,200;000404,200;603188,200;002521,200;002737,200;600229,200;603701,200;603778,200;002947,200;000049,200;600827,200;000756,200;002025,200;603505,200;002652,200;002641,200;002327,200;002135,200;000632,200;002929,200;002441,200;600721,200;002614,200;600576,200;600618,200;002272,200;002114,200;002590,200;000417,200;000409,200;600246,200;600658,200;600202,200;002435,200;002877,200;603008,200;002835,200;002842,200;002909,200;002774,200;603126,200;603557,200;600675,200;601020,200;002975,200;601869,200;002399,200;000755,200;600190,200;002907,200;601098,200;002362,200;600292,200;600876,200;002881,200;600420,200;600761,200;002691,200;002427,200;002040,200;002672,200;002532,200;603733,200;600562,200;600021,200;603081,200;000525,200;603678,200;600538,200;603601,200;002795,200;600059,200;603501,200;000922,200;002540,200;002029,200;600779,200;000797,200;002289,200;002578,200;603690,200;600081,200;603068,200;600713,200;600055,200;000910,200;600545,200;601369,200;002905,200;002448,200;600939,200;603198,200;600566,200;002189,200;603777,200;002885,200;600281,200;603267,200;600163,200;603660,200;600613,200;600513,200;002591,200;002350,200;603738,200;603528,200;002651,200;000752,200;002536,200;601019,200;002696,200;603967,200;603389,200;600299,200;603056,200;600821,200;600468,200;000544,200;002559,200;000809,200;002514,200;603026,200;002487,200;600323,200;603901,200;000951,200;000948,200;603551,200;600578,200;603790,200;603067,200;603996,200;600232,200;600917,200;000785,200;002709,200;000099,200;002409,200;002632,200;002311,200;002695,200;000780,200;603027,200;600067,200;000065,200;002613,200;002897,200;600894,200;000531,200;600173,200;600676,200;603706,200;002357,200;002494,200;000567,200;002908,200;002588,200;002949,200;600850,200;600038,200;002669,200;600998,200;002759,200;002133,200;600358,200;002140,200;000796,300;002105,300;002916,300;600476,200;000777,300;603189,300;000691,300;002401,300;601515,300;002372,300;000722,300;002251,300;002782,300;002443,300;603367,300;603606,300;600233,300;603739,300;603676,300;001914,300;002645,300;603626,300;002180,300;002903,300;000573,300;002304,300;002199,300;600859,300;002238,300;603616,300;600321,300;002213,300;600361,300;000821,300;600345,300;002605,300;600456,300;603013,300;601801,300;002404,300;600726,300;002361,300;000885,300;002225,300;603602,300;002485,300;002953,300;000905,300;603995,300;002454,300;603956,300;002179,300;002192,300;002866,300;002634,300;002664,300;002423,300;002278,300;002134,300;002571,300;601996,300;002957,300;603718,300;603011,300;000757,300;603559,300;000010,300;600600,300;000967,300;600809,300;002910,300;600686,300;002352,300;600259,300;002254,300;002212,300;600289,300;002459,300;601116,300;601518,300;002083,300;600936,300;002258,300;002364,300;000707,300;000657,300;600116,300;600481,300;002246,300;002232,300;002895,300;603005,300;600336,300;002283,300;603876,300;600033,300;002455,300;002203,300;002112,300;600257,300;603986,300;600295,300;600161,300;603619,300;603318,300;000597,300;603936,300;002558,300;000639,300;002677,300;601689,300;002480,300;001965,300;600469,300;600717,300;600984,300;002265,300;000561,300;002284,300;603681,300;000599,300;002301,300;002382,300;002626,300;600085,300;002490,300;600088,300;000045,300;600558,300;603598,300;002184,300;600396,300;002478,300;002294,300;601969,300;002347,300;603588,300;603157,300;002468,300;601886,300;601107,300;600609,300;600236,300;600113,300;002597,300;600727,300;002162,300;600592,300;603686,300;002483,300;600353,300;600805,300;000767,300;002828,300;603456,300;603915,300;002972,300;002055,300;600279,300;000513,300;002687,300;600338,300;002009,300;603348,300;601208,300;002344,300;000731,300;600781,300;002472,300;002414,300;600249,300;600668,300;002398,300;600645,300;000529,300;603858,300;600319,300;603227,300;002761,300;002206,300;002551,300;002375,300;000601,300;600830,300;603386,300;600310,300;002539,300;002593,300;000620,300;002742,300;000698,300;600480,300;600790,300;600853,300;603920,300;002433,300;603115,300;002419,300;603108,300;603888,300;601858,300;002550,300;000702,300;600872,300;600689,300;000631,300;600285,300;002546,300;600391,300;600603,300;002688,300;002863,300;601200,300;603113,300;603650,300;603863,300;603085,300;600119,300;603927,300;000638,300;002060,300;600501,300;600891,300;002434,300;600288,300;600386,300;002560,300;002355,300;000838,300;002267,300;002545,300;600372,300;603117,300;002097,300;600136,300;600973,300;002269,300;002712,300;002389,300;002298,300;000837,300;002693,300;002153,300;600135,300;002609,300;002902,300;000584,300;600077,300;600009,300;002563,300;002022,300;600738,300;002379,300;000892,300;000962,300;000609,300;600449,300;600328,300;600251,300;000027,300;002549,300;603609,300;002815,300;600892,300;601010,300;603009,300;600716,300;002582,300;000514,300;600590,300;000762,300;000581,300;600080,300;600120,300;603259,300;600258,300;002660,300;000883,300;603803,300;002424,300;002769,300;002747,300;002618,300;002300,300;002069,300;600351,300;600655,300;002172,300;002270,300;600126,300;002125,300;600388,300;002603,300;002548,300;600327,300;600845,300;600070,300;002518,300;603555,300;601928,300;000014,300;600981,300;600836,300;002689,300;002965,300;002786,300;002580,300;600037,300;600395,300;000061,300;600387,300;600640,300;600744,300;002544,300;600376,300;600757,300;000633,300;600730,300;603999,300;002387,300;000623,300;000523,300;603399,300;002061,300;000408,300;002552,300;002564,300;000902,300;002700,300;002581,300;002117,300;603618,300;603885,300;603299,300;600458,300;002204,300;000949,400;603648,300;002675,300;600121,400;002240,400;002042,400;000848,400;600322,400;603530,400;002523,400;600792,400;000993,400;600213,400;000925,400;600855,400;002946,400;603300,400;600880,400;000987,400;000637,400;000990,400;002038,400;603969,400;002624,400;002329,400;002636,400;002579,400;000720,400;600057,400;603121,400;000593,400;600298,400;000612,400;600035,400;002377,400;600230,400;600107,400;600343,400;600082,400;002482,400;600550,400;600103,400;603012,400;603032,400;002255,400;002631,400;002309,400;600197,400;600641,400;002643,400;603335,400;002453,400;002211,400;603693,400;000976,400;603687,400;002625,400;000733,400;002461,400;000788,400;000665,400;002430,400;603328,400;002006,400;000666,400;600156,400;000918,400;600062,400;002163,400;600363,400;002317,400;000088,400;600530,400;002495,400;601877,400;603697,400;002051,400;600152,400;002750,400;600630,400;600773,400;600373,400;000753,400;600191,400;002330,400;000019,400;600822,400;600702,400;600848,400;600685,400;600405,400;000887,400;002444,400;600350,400;002392,400;002572,400;600602,400;002410,400;002314,400;600192,400;002010,400;000815,400;603336,400;601179,400;600320,400;002109,400;600269,400;002231,400;600433,400;000681,400;600589,400;002962,400;002484,400;002937,400;000560,400;601616,400;601808,400;000301,400;000039,400;000151,400;002388,400;000921,400;002776,400;000791,400;002746,400;000965,400;600317,400;002783,400;600185,400;002930,400;600375,400;002493,400;000811,400;000607,400;000554,400;002048,400;000559,400;600278,400;000835,400;000586,400;601015,400;600642,400;002068,400;600597,400;600365,400;600765,400;600844,400;002154,400;603477,400;603843,400;000908,400;000510,400;002703,400;002556,400;002707,400;000090,400;600657,400;601311,400;002250,400;600674,400;002004,400;601101,400;600075,400;600807,400;000829,400;002416,400;600996,400;603111,400;002654,400;600222,400;002457,400;600416,400;600209,400;600893,400;603982,400;601218,400;002508,400;600509,400;000655,400;600318,400;002030,400;002208,400;002151,400;002683,400;603002,400;600138,400;002587,400;002320,400;600960,400;002848,400;000017,400;000938,400;002376,400;002442,400;000989,400;600195,400;002334,400;600096,400;000739,400;002726,400;000505,400;600559,400;601611,400;000861,400;600106,400;002432,400;002325,400;002725,400;000860,400;600540,400;002085,400;002166,400;002149,400;000690,400;002657,400;002345,400;002222,400;000687,400;002337,400;600371,400;002043,400;600760,400;002358,400;002201,400;600743,400;000761,400;002374,400;002028,400;600128,400;002316,400;600866,400;002126,400;000935,400;000959,400;002538,400;600633,400;600537,400;000537,400;600611,400;600131,400;601888,400;603998,400;002386,400;600266,400;600798,400;600390,400;000900,400;603327,400;001896,400;002158,400;002476,400;603106,400;601238,400;002080,400;002318,400;600649,400;600735,400;000156,400;600303,400;000530,400;002223,400;002383,400;002064,400;002368,400;000007,400;601139,400;000721,400;000738,400;000600,400;600293,400;600242,400;000856,400;600491,500;002417,500;600428,500;002291,500;000532,500;000402,500;600626,500;603363,500;002160,500;000926,500;002516,500;000521,500;600203,500;600400,500;600333,500;002542,500;002570,500;002439,500;603636,500;601828,500;002343,500;002535,500;601599,500;603369,500;600200,500;600056,500;002697,500;002296,500;600535,500;000038,500;002507,500;002822,500;002594,500;600888,500;002297,500;000822,500;002020,500;000036,500;600528,500;601086,500;002378,500;600654,500;002353,500;000407,500;000545,500;000850,500;002174,500;600090,500;000901,500;600977,500;002522,500;000005,500;600660,500;000903,500;002167,500;600586,500;000802,500;000034,500;600312,500;600712,500;600237,500;000603,500;600802,500;000931,500;000799,500;002268,500;002422,500;002573,500;002479,500;600622,500;002091,500;600662,500;000568,500;002629,500;603766,500;600284,500;600502,500;002171,500;002717,500;600207,500;002714,500;600787,500;002371,500;000400,500;600459,500;600397,500;600715,500;600500,500;600748,500;600316,500;600684,500;600123,500;002492,500;601038,500;600908,500;002356,500;601326,500;601908,500;600225,500;600114,500;000598,500;000056,500;002474,500;600594,500;600881,500;002511,500;002197,500;002266,500;002342,500;002168,500;000718,500;002708,500;600335,500;600118,500;600699,500;001696,500;002198,500;000852,500;601001,500;000420,500;000615,500;600739,500;600415,500;600199,500;000150,500;002121,500;000606,500;002530,500;600533,500;002938,500;000969,500;002604,500;600220,500;600268,500;600707,500;601991,500;002214,500;600623,500;000520,500;002262,500;002449,500;002047,500;600634,500;600398,500;000613,500;600997,500;002228,500;002519,500;600971,500;002648,500;002649,500;002224,500;600571,500;002601,500;600745,500;002094,500;603366,500;002016,500;002528,500;600698,500;600052,500;000410,500;000416,500;000950,500;000543,500;002745,500;600332,500;000557,500;002971,500;600862,500;000589,500;002370,500;603712,500;600308,500;601360,500;002323,500;002328,500;002733,500;601228,500;600177,500;000498,500;600637,500;600959,500;000552,500;002489,500;000963,500;002007,500;600820,500;000518,500;600741,500;600133,500;600722,500;002348,500;000890,600;600169,600;002702,600;601949,600;002961,600;002585,600;601607,600;601628,600;002234,600;002332,600;002941,600;000801,600;600117,600;600874,600;600060,600;000937,600;002220,600;600688,600;000997,600;601002,600;000813,600;002138,600;600580,600;600710,600;600496,600;601958,600;600929,600;600800,600;000966,600;601789,600;002106,600;000826,600;600261,600;600141,600;600079,600;002071,600;000712,600;002035,600;000627,600;603169,600;002148,600;002396,600;600217,600;603220,600;600153,600;000610,600;002277,600;600291,600;000682,600;002807,600;002164,600;002128,600;600803,600;000059,600;002271,600;002390,600;002303,600;600064,600;002081,600;600235,600;600280,600;002279,600;000031,600;002215,600;600076,600;000751,600;000928,600;002351,600;000680,600;002305,600;000957,600;002281,600;002531,600;000576,600;002471,600;600747,600;000800,600;600652,600;601512,600;600359,600;601898,600;002067,600;002221,600;000006,600;000786,600;000912,600;603195,600;600967,600;600201,600;600448,600;002194,600;000996,600;002072,600;600084,600;600499,600;000895,600;000155,600;000055,600;000046,600;600066,600;600718,600;002087,600;600467,600;600470,600;600439,600;002292,600;600004,600;600337,600;600963,600;600549,600;600139,600;600643,600;002141,600;600073,600;600701,600;000503,600;000766,600;000711,600;600477,600;600223,600;002367,600;600783,600;000659,600;002073,600;000703,600;002264,600;601008,600;002440,600;600146,600;600966,600;600346,600;600158,600;600006,600;000012,600;002233,600;002973,600;600869,600;002666,600;002119,600;002086,600;002562,600;603105,600;002326,600;000035,600;002692,600;002182,600;600418,600;000716,600;002243,600;600495,600;600227,600;000729,700;002602,700;002170,700;600061,700;002132,700;002515,700;600112,700;603815,700;601633,700;002425,700;600150,700;002127,700;000558,700;600552,700;600704,700;002583,700;002093,700;002245,700;002431,700;002104,700;600825,700;000818,700;000507,700;600023,700;600863,700;601619,700;600151,700;000058,700;600810,700;002019,700;002721,700;002701,700;002411,700;600766,700;600017,700;000089,700;002491,700;603118,700;601231,700;000810,700;000677,700;600305,700;600162,700;000676,700;600653,700;600515,700;002504,700;000700,700;002226,700;600127,700;002655,700;600267,700;601997,700;600736,700;601222,700;600406,700;002299,700;603256,700;600582,700;600078,700;002575,700;002967,700;000571,700;600521,700;600756,700;601336,700;002736,700;002050,700;002247,700;000927,700;002537,700;600252,700;000667,700;000930,700;002031,700;002694,700;600355,700;600999,700;002670,700;600678,700;002366,700;002663,700;000980,700;002036,700;600570,700;002145,700;600186,700;002244,700;600063,700;002308,700;002276,700;601588,700;002408,700;600340,700;600368,700;601890,700;600026,700;601717,700;002373,700;601952,700;600708,700;600072,700;002635,700;600651,700;600823,700;600517,700;002676,700;002123,700;002770,700;600125,700;000886,700;002413,700;600873,700;002555,700;002137,700;000878,700;600737,700;000616,800;002044,700;002488,800;002139,800;002656,800;600903,800;601727,800;600212,800;600498,800;002699,800;002407,800;600811,800;000998,800;600682,800;600478,800;603323,800;002178,800;600875,800;002501,800;600978,800;002017,800;002302,800;600532,800;601330,800;600758,800;002130,800;600187,800;002486,800;603093,800;002074,800;002458,800;000975,800;002008,800;600770,800;000669,800;002524,800;002502,800;002567,800;600846,800;600422,800;601929,800;000973,800;603053,800;600239,800;600565,800;600276,800;600231,800;002285,800;601155,800;600601,800;002181,800;600380,800;000595,800;600691,800;600260,800;002739,800;002218,800;002041,800;000790,800;601866,800;600527,800;600583,800;002011,800;002076,800;002662,800;000622,800;600975,800;002115,800;600884,800;601018,800;600900,800;002640,800;000555,800;002045,800;600926,800;002498,800;002142,800;000960,800;600577,800;000958,800;601606,800;601666,800;002606,800;002628,800;000732,800;002108,800;601106,800;600069,800;002464,800;601069,800;000591,800;600462,800;000516,800;600435,800;002191,800;002229,800;000547,800;000662,800;601198,800;600271,800;600095,800;002057,800;002680,800;600546,800;000159,800;600555,800;600297,800;601016,800;002070,800;000768,900;600105,900;603390,900;002092,900;002100,900;000533,900;002098,900;600886,900;600339,900;600218,900;600198,900;600775,900;601918,900;601577,900;002321,900;603128,900;002103,900;600300,900;600210,900;002969,900;000566,900;600426,900;002054,900;002018,900;600755,900;600277,900;002183,900;002451,900;600812,900;600801,900;601865,900;600011,900;600720,900;603000,900;600143,900;600362,900;000875,900;002099,900;601003,900;002063,900;601058,900;002421,900;002354,900;600970,900;000882,900;600326,900;002052,900;000488,900;600348,900;600330,900;600196,900;600039,900;000970,900;000862,900;000812,900;002001,900;000040,900;600507,900;601718,900;600094,900;000652,900;000068,900;002249,900;601005,900;600895,900;600831,900;600155,900;600673,900;600466,900;002077,900;002496,1000;000158,1000;600089,1000;002169,1000;600216,1000;002274,1000;600531,1000;600093,1000;600172,1000;000672,1000;601088,1000;601788,1000;600100,1000;600366,1000;000877,1000;601880,1000;002554,1000;002013,1000;000823,1000;601168,1000;002470,1000;001979,1000;002312,1000;002175,1000;600273,1000;000713,1000;600130,1000;600108,1000;000656,1000;002650,1000;002639,1000;601678,1000;600867,1000;601608,1000;601838,1000;600104,1000;600695,1000;601601,1000;600733,1000;601919,1000;000758,1000;601117,1000;000778,1000;002155,1000;603019,1000;600331,1000;002307,1000;600503,1000;002589,1000;000851,1000;000625,1000;601800,1000;002428,1000;601233,1000;002584,1000;000517,1000;000988,1000;600575,1000;600871,1000;600008,1000;601985,1000;002402,1000;002638,1000;002446,1000;000509,1100;000070,1100;002619,1100;601669,1100;002156,1100;002341,1100;600687,1100;002049,1100;601128,1100;000519,1100;000528,1100;600901,1100;601777,1100;002012,1100;000831,1100;600015,1100;600188,1100;600596,1100;601011,1100;600588,1100;000898,1100;600621,1100;002078,1100;000936,1100;002110,1100;002510,1100;000728,1100;002466,1100;600020,1100;600354,1100;600989,1100;601229,1100;601333,1100;002202,1100;000955,1100;000686,1100;600425,1100;000789,1100;000018,1100;600734,1100;600122,1100;600856,1100;000426,1100;002681,1100;601700,1100;002219,1100;600958,1100;600255,1100;600309,1100;601388,1100;002611,1100;600170,1100;000415,1100;600740,1100;000983,1100;002273,1200;002056,1200;600165,1200;600664,1200;002465,1200;600446,1200;002711,1200;600536,1200;000016,1200;600160,1200;600110,1200;002607,1200;600171,1200;000008,1200;600547,1200;000859,1200;000961,1200;600624,1200;002497,1200;601872,1200;600598,1200;600409,1200;002143,1200;600383,1200;603799,1200;002079,1200;002124,1200;600794,1200;600311,1200;002177,1200;002400,1200;601375,1200;002369,1200;000564,1200;000816,1300;002948,1300;601699,1300;600027,1300;600585,1300;000858,1300;601211,1300;601615,1300;600804,1300;600797,1300;601212,1300;000836,1300;000795,1300;002936,1300;002926,1300;002500,1300;000917,1300;000078,1300;002418,1300;002460,1300;600909,1300;002161,1300;000050,1300;002152,1300;601555,1300;000060,1300;600879,1300;000401,1300;600325,1300;601068,1300;600360,1300;002839,1300;000333,1300;002023,1300;000671,1300;002288,1300;002075,1300;600176,1300;601998,1300;000506,1300;002596,1300;601118,1400;002437,1400;600986,1400;600490,1400;600183,1400;601000,1400;600751,1400;600497,1400;600776,1400;002503,1400;600313,1400;600512,1400;601298,1400;002237,1400;600864,1400;002113,1400;601012,1400;600307,1400;600018,1400;002565,1400;600109,1400;600206,1400;000009,1400;002512,1400;601901,1400;600919,1400;002673,1500;600487,1500;002526,1500;000021,1500;601006,1500;002176,1500;000592,1500;000157,1500;002256,1500;002617,1500;002630,1500;000783,1500;600569,1500;600928,1500;601636,1500;601878,1500;600392,1500;600525,1500;600728,1500;002506,1500;002146,1500;000776,1500;600868,1600;600438,1600;002118,1600;600068,1600;600000,1600;002310,1600;000673,1600;002261,1600;600789,1600;002384,1600;002429,1600;000069,1600;000650,1600;002280,1600;002966,1600;002230,1600;600690,1600;600667,1600;002481,1600;600705,1700;600489,1700;000876,1700;600666,1700;000683,1700;600581,1700;600369,1700;002475,1700;600839,1700;002235,1700;601881,1700;600584,1700;601216,1700;600614,1800;600240,1800;002405,1800;002958,1800;000830,1800;601519,1800;601598,1800;002467,1800;600522,1800;002509,1800;601169,1800;002945,1800;600410,1900;000933,1900;002622,1900;002426,1900;002415,1900;601992,1900;600572,1900;002065,1900;600782,1900;601860,1900;002236,1900;002517,1900;000709,1900;600759,1900;600025,1900;600393,1900;601390,1900;000825,1900;000717,2000;600808,2000;600795,2000;002665,2000;002239,2000;000166,2000;002436,2000;002024,2000;000587,2000;000793,2000;002241,2000;601225,2100;002939,2100;601618,2100;000977,2100;600816,2100;600604,2100;600111,2100;600036,2100;600256,2100;000651,2100;600401,2100;002505,2200;600282,2200;600166,2200;600115,2200;600567,2200;002157,2200;000807,2200;600988,2200;000002,2200;601009,2200;601933,2300;002002,2300;600606,2300;600516,2300;000636,2300;000932,2300;000536,2300;002447,2300;600086,2300;601111,2300;600711,2300;000839,2300;600887,2300;601377,2300;600777,2300;600635,2400;601766,2400;603077,2400;601186,2400;600568,2400;601138,2400;000727,2400;002463,2400;601066,2400;000630,2400;000563,2500;002668,2500;601108,2500;000338,2500;600219,2500;002385,2500;002217,2500;600460,2600;601857,2700;601698,2700;002252,2700;600019,2700;000540,2700;601688,2800;600208,2800;002129,2800;601077,2800;002547,2900;601318,2900;002610,2900;601990,2900;600837,3000;600029,3000;600352,3000;600175,3100;000735,3100;601236,3100;600226,3100;600022,3100;601166,3200;600703,3200;601975,3200;600016,3200;002340,3300;600221,3300;000066,3300;000425,3400;601319,3400;600031,3500;000723,3500;002185,3600;000750,3600;002477,3600;601600,3800;601328,3800;600048,3900;002797,3900;601989,3900;002456,4000;601162,4100;000413,4100;600968,4100;000629,4100;003816,4100;601818,4300;002600,4300;601939,4400;000001,4500;002195,4900;000063,5000;002027,5000;002131,5100;600028,5100;601916,5400;601099,5600;601988,5700;600030,5800;601658,5900;603993,6100;600050,6200;601668,6200;000100,7400;600157,7900;601899,8000;601398,8300;600010,8800;601288,11900;601816,18700;000725,28800;";
    private static Map <String,Integer> stockBaseVolMap ;
    private static Map<String,Integer> minute2IntMap ;

    @Autowired
    private StockDao stockDao  ;

    @Autowired
    private BsStaticDataService bsStaticDataService;

    @Autowired
    private BaseDao baseDao;


    static{
        getMinute2IntMap();
        stockBaseVolMap();
    }


    public String saveStockZSMinuteData() {
        String result = "error";
        String filePath = "E:\\stock\\data\\zhishu_minute\\SH#603919.txt";
        String dealZSDataMinuteDealTimeKey = "STOCK_DEAL_TIME_STOCK_MINUTEANA";
        String lastDealDayStr =  (String) baseDao.selectOne(ConstantsInfo.SQLID.GET_CODEVALUE ,dealZSDataMinuteDealTimeKey) ;
        if (lastDealDayStr != null) {
            try {
                Timestamp lastDealDay = DateUtil.convertStringToTimestamp(lastDealDayStr, "yyyy-MM-dd");
                if (lastDealDay.before(DateUtil.getCurrentDate())) {
                    File file = new File(filePath);
                    if(file.exists()){
                        putStockDataMinuteFile2DB(file, lastDealDay,"");

//                        bsStaticDataService.updateDealTime(dealZSDataMinuteDealTimeKey);
                        result= "success";
                    }else{
                        logger.error(filePath+" 不存在");
                        result = "error";
                    }
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        //603682 sz002951 002952 002958
        return result;
    }





    private void  putStockDataMinuteFile2DB(File file,Timestamp lastDealDay,String type ) {
        try{


            List stockList = new ArrayList();
            //file 示例 SH#600000.txt
            String fileName = file.getName();
            String stockCode = fileName.substring(3,9);
            Map hisMap = new HashMap(); //存放前一天收盘价，用于计算涨停和跌停

            List  list = FileUtil.readFileXml(file,"gbk");
            int number = 0;
            List stockMinuteAnaList = new ArrayList();
            for(int i=0; i<list.size();i++){
                String line = (String) list.get(i);
                if(line.contains("日期")){
                    continue; //标题跳过.
                }
                // 标题  日期	    开盘	    最高	    最低	    收盘	    成交量	    成交额
                //2010/01/04	6.69	6.70	6.41	6.42	66191338	1419984128.00
                String[] cols = line.split("\t");
                if(cols.length>7){
                    if(DateUtil.convertStringToTimestamp(cols[0],"yyyy/MM/dd").after(lastDealDay)){
                        StockMinuteAna bean =  getStockBeanForMinuteFromLine(hisMap,list,i);
                        bean.setStockCode(stockCode);
                        stockList.add(bean);
                        if(bean.getTimeSeq()==240){
                            put2StockMinuteAna(stockList,stockMinuteAnaList,stockCode);
                            stockList.clear();
                        }
                    }
                }
                if(stockMinuteAnaList.size()>=2000){
                    number= number+stockMinuteAnaList.size();
                    logger.info(stockCode+"stockMinuteAnaList size="+number);
                    insertStockMinuteAnaList2DB(stockMinuteAnaList);
//                    baseDao.insert(sqlId,stockList);
//                    stockDao.insertStockMinuteList(stockList);
                    stockList.clear();
                }
            }

            if(stockMinuteAnaList.size()>0){
                number= number+stockMinuteAnaList.size();
                logger.info(stockCode+"stockMinuteAnaList size="+number);
                insertStockMinuteAnaList2DB(stockMinuteAnaList);
//                stockDao.insertStockMinuteList(stockList);
            }
        }catch (Exception e){
            logger.error("putStockDataFile2DDB_err",e);
        }

    }


    private void put2StockMinuteAna(List<StockMinuteAna>  stockList, List stockAnaList,String  stockCode){


        long max10Vol= 0L;
        long max10AvgVol= 0L;
        long max40Vol= 0L;
        List<StockMinuteAna>  tmpList = new ArrayList();
        tmpList.addAll(stockList);
        Collections.sort(tmpList);
       for(int i=0;i<10;i++){
           StockMinuteAna bean =  tmpList.get(i);
           max10Vol = max10Vol+bean.getVolume();
       }
        max10AvgVol = max10Vol/10;
       int bigoffset = 0;
        for(int i=9;i>=0;i--){
            StockMinuteAna bean =  tmpList.get(i);
            if(bean.getVolume()*100/max10AvgVol>50){
                bigoffset = i;
                break;
            }
        }
        Map stockVolSignMap = new HashMap();
      for(int i=0;i<40;i++){
          StockMinuteAna bean =  tmpList.get(i);
            if(i<=bigoffset){
                stockVolSignMap.put(bean.getTimeSeq(),"1");
            }else {
                stockVolSignMap.put(bean.getTimeSeq(),"2");
            }
    }
        Map<String, Long> hisMap = new HashMap();
        initHisVolMap(hisMap);

       int lastBigTimeSeq = 0 ;
       int baseVol = stockBaseVolMap.get(stockCode);
       for(int i=0; i<stockList.size();i++){
           StockMinuteAna bean =  stockList.get(i);
           if ("1".equals(stockVolSignMap.get(bean.getTimeSeq())) || (i == 0) || (i == 240)) {
               setVol(hisMap, bean, 1);
               int diffMinuteNum = 0;
               if(i == 0){
                   hisMap.put("hisBigTimeSeq",0L);
                   diffMinuteNum =1;
               }else{
                   diffMinuteNum = i -lastBigTimeSeq;
                   lastBigTimeSeq = i;

               }
               bean.setBigVolB( Math.round( hisMap.get("bigVolB")*10/(baseVol*diffMinuteNum)));
               bean.setBigVolS(Math.round( hisMap.get("bigVolS")*10/(baseVol*diffMinuteNum)));
               bean.setFlowVolB(Math.round( hisMap.get("flowVolB")*10/(baseVol*diffMinuteNum)));
               bean.setFlowVolS(Math.round( hisMap.get("flowVolS")*10/(baseVol*diffMinuteNum)) );
               bean.setNorVolB(Math.round( hisMap.get("norVolB")*10/(baseVol*diffMinuteNum)) );
               bean.setNorVolS(Math.round( hisMap.get("norVolS")*10/(baseVol*diffMinuteNum)));
               stockAnaList.add(bean);
               initHisVolMap(hisMap);
           } else if ("2".equals(stockVolSignMap.get(bean.getTimeSeq()))) {
               setVol(hisMap, bean, 2);
           } else {
               setVol(hisMap, bean, 3);
           }

       }
    }


    private void setVol(Map<String ,Long>  hisMap,StockMinuteAna bean, int volType){

        int  volBSType = 0; //1  大单; 2 跟随 ; 3 普通
        int updDownType = 0; //1 上涨 2下跌
        if(bean.getClosePrice()>bean.getOpenPrice()){
            updDownType = 1;
        }else if(bean.getClosePrice()==bean.getOpenPrice() ){
            if(bean.getHighPrice()-bean.getOpenPrice()>bean.getOpenPrice()-bean.getLowPrice()){
                updDownType = 1;
            }else{
                updDownType = 2;
            }
        }else{
            updDownType = 2;
        }

        if(volType ==1){
             if(updDownType==1){
                 hisMap.put("bigVolB", hisMap.get("bigVolB")+bean.getVolume());
             }else if(updDownType==2){
                 hisMap.put("bigVolS", hisMap.get("bigVolS")+bean.getVolume());
             }
        }else if(volType ==2){
            if(updDownType==1){
                hisMap.put("flowVolB", hisMap.get("flowVolB")+bean.getVolume());
            }else if(updDownType==2){
                hisMap.put("flowVolS", hisMap.get("flowVolS")+bean.getVolume());
            }
        }else if(volType ==3){
            if(updDownType==1){
                hisMap.put("norVolB", hisMap.get("norVolB")+bean.getVolume());
            }else if(updDownType==2){
                hisMap.put("norVolS", hisMap.get("norVolS")+bean.getVolume());
            }
        }
    }

    private void initHisVolMap( Map<String, Long> hisMap ){
        hisMap.put("bigVolS",0L);
        hisMap.put("bigVolB",0L);
        hisMap.put("flowVolS",0L);
        hisMap.put("flowVolB",0L);
        hisMap.put("norVolS",0L);
        hisMap.put("norVolB",0L);
    }



    private void insertStockMinuteList2DB(List stockList, String stockCode,String type){
        String sqlId = null;
        if("ZS".equals(type)){
            sqlId = "com.guoxc.info.dao.StockDao.insertStockMinuteZSList";
            baseDao.insert(sqlId,stockList);
        }else{
            sqlId= "com.guoxc.info.dao.StockDao.insertStockMinuteList";
            Map param = new HashMap();
            param.put("tableName","t_st_min_"+stockCode);
            param.put("list",stockList);
            baseDao.insert(sqlId,param);

        }

    }


    private void insertStockMinuteAnaList2DB(List stockMinuteAnaList){
        String sqlId =  "com.guoxc.info.dao.StockMinute.insertStockMinuteAnaList";
            baseDao.insert(sqlId,stockMinuteAnaList);



    }



    private  StockMinuteAna getStockBeanForMinuteFromLine( Map hisMap, List list, int index) throws ParseException {
        StockMinuteAna result = new StockMinuteAna();
        Float preClosePrice =  (Float)hisMap.get("preClosePrice");
        if(preClosePrice == null && index>0  ){
            StockMinuteAna bean =   getBaseStockDayBeanForMinute(list,index-1);
            preClosePrice = bean.getClosePrice();
            hisMap.put("preClosePrice",preClosePrice);
        }

        StockMinuteAna bean =   getBaseStockDayBeanForMinute(list,index);
        BeanUtils.copyProperties(bean,result);
        result.setPriceRate( Math.round(   (result.getClosePrice()-result.getOpenPrice())*1000/result.getOpenPrice()) );
        result.setSwing(  Math.round((result.getHighPrice()- result.getLowPrice())*1000/result.getOpenPrice()));
        if(preClosePrice != null){
            if(result.getHighPrice()>preClosePrice){ //上涨
               if(result.getHighPrice() ==Math.round(preClosePrice*1.1)){
                   result.setMaxUpDown(1);
               }
            }else{ //下跌
                if(result.getLowPrice() ==Math.round(preClosePrice*0.9)){
                    result.setMaxUpDown(2);
                }
            }
        }
        return result;
    }




    private   StockMinuteAna   getBaseStockDayBeanForMinute(List list ,int index)throws ParseException {
        StockMinuteAna bean = new StockMinuteAna();
        String line = (String) list.get(index);
        String[] cols = line.split("\t");
        if(cols.length>=8){
            bean.setOperTime(DateUtil.convertStringToTimestamp(cols[0],"yyyy/MM/dd"));
            bean.setTimeSeq(minute2IntMap.get(cols[1]));
            bean.setOpenPrice(Float.valueOf(cols[2]));
            bean.setHighPrice(Float.valueOf(cols[3]));
            bean.setLowPrice(Float.valueOf(cols[4]));
            bean.setClosePrice(Float.valueOf(cols[5]));
            bean.setVolume(Long.valueOf(cols[6])/100);
        }
        return bean;
    }










    private static Map getMinute2IntMap(){
        if(minute2IntMap== null ){
            minute2IntMap = new HashMap();
            String[] keyValueArray = minute2IntStr.split(";");
            for(String keyValue:keyValueArray){
                String[] cols = keyValue.split(",");
                minute2IntMap.put(cols[0],Integer.parseInt(cols[1]));
            }
        }
        return minute2IntMap;
    }

    private static Map stockBaseVolMap(){
         if(stockBaseVolMap== null ){
             stockBaseVolMap = new HashMap();
             String[] keyValueArray = stockBaseVol.split(";");
             for(String keyValue:keyValueArray){
                 String[] cols = keyValue.split(",");
                 stockBaseVolMap.put(cols[0],Integer.parseInt(cols[1]));
             }
         }
          return stockBaseVolMap;
    }

}
